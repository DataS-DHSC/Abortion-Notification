{% extends "layouts/main.html" %}
{% from "govuk/components/tag/macro.njk"    import govukTag    %}
{% from "govuk/components/button/macro.njk" import govukButton %}


{% block pageTitle %}Forms â€“ Abortion Notification Service{% endblock %}

{% block content %}

  {{ govukButton({
    text: "Add a new form",
    href: "/forms/new",
    classes: "govuk-!-margin-bottom-6"
  }) }}

  <form method="get" class="govuk-!-margin-bottom-6">
    <div class="govuk-form-group">
      <label class="govuk-label" for="q">Find a form</label>
      <span class="govuk-hint">Search by form ID, patient reference, clinic name or clinic number</span>
      <input class="govuk-input" id="q" name="q" type="search" value="{{ search | escape }}" autocomplete="off">
    </div>
    {{ govukButton({ text: "Search" }) }}
  </form>

  <table class="govuk-table">
    <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th scope="col" class="govuk-table__header">Date created</th>
        <th scope="col" class="govuk-table__header">Form ID</th>
        <th scope="col" class="govuk-table__header">Patient reference</th>
        <th scope="col" class="govuk-table__header">Clinic</th>
        <th scope="col" class="govuk-table__header">Form status</th>
        <th scope="col" class="govuk-table__header">Actions</th>
      </tr>
    </thead>
    <tbody class="govuk-table__body">
      {% for f in forms %}
        <tr class="govuk-table__row">
          <td class="govuk-table__cell">{{ f.dateCreated }}</td>
          <td class="govuk-table__cell">{{ f.formId }}</td>
          <td class="govuk-table__cell">{{ f.patientReference }}</td>
          <td class="govuk-table__cell">{{ f.clinicName }}</td>
          <td class="govuk-table__cell">
            {% if f.formStatus == 'SUBMITTED' %}
              {{ govukTag({ text: f.formStatus, classes: 'govuk-tag--green' }) }}
            {% elif f.formStatus == 'RETURNED' %}
              {{ govukTag({ text: f.formStatus, classes: 'govuk-tag--red' }) }}
            {% else %}
              {{ govukTag({ text: f.formStatus, classes: 'govuk-tag--yellow' }) }}
            {% endif %}
          </td>
          <td class="govuk-table__cell">
            <a class="govuk-link" href="/forms/{{ f.formId }}">Review</a>
            &nbsp;&nbsp;
            <a class="govuk-link" href="/forms/{{ f.formId }}/archive">Archive</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {# ---------------- Pagination (Design-System component) ---------------- #}
  {% if totalPages > 1 %}  {{ govukPagination(pagination) }}  {% endif %}

{% endblock %}
